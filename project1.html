<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script defer src="js/JavaScript.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Roboto+Mono:ital,wght@1,200&display=swap"
    rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="style.css/style.css" />
</head>
<body>
    <div class="BG3">
        <div class="wrapper">

      <header class="main-header">
        <div class="container">
            <div class="logo">
                <a href="index.html">
                    <h2>Pierre BAUDU</h2>
                </a>
            </div>
            
            <nav class="main-nav">
                <ul>
                
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#experiences">Experiences</a></li>
                    <li><a href="index.html#education">Education</a></li>
                    <li><a href="Earth Obs. & ML.html">Earth Obs. & ML</a></li>
                    <li><a href="Planets.html">Planets Obs.</a></li>
                    <li><a href="Galaxy.html">Galaxy Obs.</a></li>
                </ul>
            </nav>

            <div class="social-links">
                <a href="https://github.com/Pedro911-maker" target="_blank" aria-label="GitHub">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                </a>
                <a href="https://www.linkedin.com/in/pierre-baudu-8b81071ab/" target="_blank" aria-label="LinkedIn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                    </svg>
                </a>
            </div>
        </div>
    </header>


      <main class="project-page">

        <!-- CARD TITRE -->
        <br><br><br>
      <section class="section-card" id="titanic-predictor">
        <h2>Tester le modèle : prédire la survie d’un passager</h2>
            <p>
              Choisis les caractéristiques d’un passager pour estimer sa probabilité de survie
              selon le modèle entraîné sur le jeu de données Titanic.
            </p>

            <form id="titanic-form" class="titanic-form" action="#" onsubmit="return false;">
              <div class="form-row">
                <div class="form-field">
                  <label for="pclass">Classe</label>
                  <select id="pclass" name="pclass">
                    <option value="1">1ère classe</option>
                    <option value="2">2ème classe</option>
                    <option value="3" selected>3ème classe</option>
                  </select>
                </div>

                <div class="form-field">
                  <label for="sex">Sexe</label>
                  <select id="sex" name="sex">
                    <option value="male">Homme</option>
                    <option value="female">Femme</option>
                  </select>
                </div>

                <div class="form-field">
                  <label for="age">Âge</label>
                  <input type="number" id="age" name="age" min="0" max="100" step="1" placeholder="Ex : 29">
                </div>
              </div>

              <div class="form-row">
                <div class="form-field">
                  <label for="sibsp">Frères / sœurs / conjoint à bord (SibSp)</label>
                  <input type="number" id="sibsp" name="sibsp" min="0" max="10" step="1" placeholder="Ex : 1">
                </div>

                <div class="form-field">
                  <label for="parch">Parents / enfants à bord (Parch)</label>
                  <input type="number" id="parch" name="parch" min="0" max="10" step="1" placeholder="Ex : 0">
                </div>

                <div class="form-field">
                  <label for="fare">Tarif du billet (£)</label>
                  <input type="number" id="fare" name="fare" min="0" step="0.1" placeholder="Ex : 35.5">
                </div>
              </div>

              <div class="form-row">
                <div class="form-field">
                  <label for="embarked">Port d’embarquement</label>
                  <select id="embarked" name="embarked">
                    <option value="S">Southampton (S)</option>
                    <option value="C">Cherbourg (C)</option>
                    <option value="Q">Queenstown (Q)</option>
                  </select>
                </div>
              </div>

              <button type="button" class="btn" id="predict-btn">
                Prédire la survie
              </button>
            </form>

            <div id="titanic-result" class="prediction-result">
              <p>Résultat de la prédiction : <em>en attente de saisie</em>.</p>
            </div>
          </section>


          <script>
          (function () {
            console.log("Titanic predictor script loaded");

            // --- Encodage des variables catégorielles ---
            function encodeSex(sex) {
              const s = (sex || "").toLowerCase().trim();
              if (s === "female" || s === "f" || s === "femme") return 0;
              if (s === "male"   || s === "m" || s === "homme") return 1;
              return 1; // défaut : homme
            }

            function encodeEmbarked(port) {
              const p = (port || "").toUpperCase().trim();
              // Mapping type LabelEncoder(['C', 'Q', 'S']) -> [0, 1, 2]
              if (p === "C") return 0;
              if (p === "Q") return 1;
              if (p === "S") return 2;
              return 2; // défaut : S
            }

            // --- Paramètres du scaler + modèle (exemple cohérent) ---
            const TITANIC_MEANS = [
              2.29,  // Pclass
              0.64,  // Sex
              29.26, // Age
              0.50,  // SibSp
              0.39,  // Parch
              33.28, // Fare
              1.49,  // Embarked
              1.88,  // FamilySize
              0.60   // IsAlone
            ];

            const TITANIC_SCALES = [
              0.84,  // Pclass
              0.48,  // Sex
              13.21, // Age
              1.04,  // SibSp
              0.87,  // Parch
              51.72, // Fare
              0.81,  // Embarked
              1.58,  // FamilySize
              0.49   // IsAlone
            ];

            const TITANIC_COEF = [
              -0.84,  // Pclass
              -1.73,  // Sex
              -0.49,  // Age
              -0.41,  // SibSp
              0.01,   // Parch
              0.03,   // Fare
              0.00,   // Embarked
              -0.27,  // FamilySize
              -0.30   // IsAlone
            ];

            const TITANIC_INTERCEPT = -0.73;

            function predictTitanicSurvival(input) {
              const pclass   = Number(input.pclass);
              const sexEnc   = encodeSex(input.sex);
              const age      = Number(input.age);
              const sibsp    = Number(input.sibsp);
              const parch    = Number(input.parch);
              const fare     = Number(input.fare);
              const embEnc   = encodeEmbarked(input.embarked);

              const familySize = sibsp + parch + 1;
              const isAlone    = (familySize === 1) ? 1 : 0;

              const features = [
                pclass,
                sexEnc,
                age,
                sibsp,
                parch,
                fare,
                embEnc,
                familySize,
                isAlone
              ];

              // Standardisation
              const scaled = features.map(function (v, i) {
                return (v - TITANIC_MEANS[i]) / TITANIC_SCALES[i];
              });

              // Logit = w.x + b
              var z = TITANIC_INTERCEPT;
              for (var i = 0; i < scaled.length; i++) {
                z += scaled[i] * TITANIC_COEF[i];
              }

              const proba = 1 / (1 + Math.exp(-z));
              const survived = proba >= 0.5;

              return { proba: proba, survived: survived };
            }

            // --- Raccord avec le formulaire ---
            const btn = document.getElementById("predict-btn");
            const resultDiv = document.getElementById("titanic-result");

            if (!btn || !resultDiv) {
              console.warn("Titanic form elements not found");
              return;
            }

            btn.addEventListener("click", function () {
              const pclass   = document.getElementById("pclass").value;
              const sex      = document.getElementById("sex").value;
              const ageVal   = document.getElementById("age").value;
              const sibspVal = document.getElementById("sibsp").value;
              const parchVal = document.getElementById("parch").value;
              const fareVal  = document.getElementById("fare").value;
              const embarked = document.getElementById("embarked").value;

              const input = {
                pclass:   pclass   || 3,
                sex:      sex      || "male",
                age:      ageVal   || 30,
                sibsp:    sibspVal || 0,
                parch:    parchVal || 0,
                fare:     fareVal  || 30,
                embarked: embarked || "S"
              };

              const prediction = predictTitanicSurvival(input);
              const probaPct = (prediction.proba * 100).toFixed(1);

              resultDiv.innerHTML = `
                <div class="section-card">
                  <h3>Résultat de la prédiction</h3>
                  <p>Probabilité de survie estimée&nbsp;: 
                    <strong>${probaPct}%</strong>
                  </p>
                  <p>
                    Selon le modèle, ce passager 
                    <strong style="color:${prediction.survived ? '#4caf50' : '#e53935'};">
                      ${prediction.survived ? 'aurait survécu.' : 'n’aurait probablement pas survécu.'}
                    </strong>
                  </p>
                  <p class="subtitle">
                    Modèle type régression logistique, inspiré de mon entraînement Python sur le dataset Titanic,
                    avec normalisation des variables et features dérivées (FamilySize, IsAlone).
                  </p>
                </div>
              `;
            });
          })();
          </script>

      </main>
      <p class="back-link">
          <a href="Earth Obs. &amp; ML.html" class="btn">← Retour à Earth Obs. &amp; ML</a>
        </p>

      <footer>
        <p>© 2021 AstroWeb. Tous droits réservés.</p>
      </footer>

    </div>
  </div>  
</body>
</html>